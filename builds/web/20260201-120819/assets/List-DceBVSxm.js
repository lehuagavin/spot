import{u as S,r as s,z as o,t,A as k,B as b,D as w,a8 as z}from"./index-vJliTLcA.js";import{g as I,u as C}from"./users-goSly9qg.js";import{D as _}from"./DefaultAvatar-BHbKO5BL.js";import{E as D}from"./EmptyState-BSaaD0E3.js";import{S as T,d as B}from"./Pagination-BDGMd9qO.js";import{F as E}from"./Table-CXsedqLq.js";import{T as R}from"./index-Bt7cSXZv.js";import{S as M}from"./index-DxXaTdAy.js";import"./upload-BK1CmKxZ.js";function V(){const d=S(),[h,i]=s.useState(!1),[m,p]=s.useState([]),[u,g]=s.useState(0),[r,n]=s.useState({page:1,page_size:10});s.useEffect(()=>{l()},[r]);const l=async()=>{i(!0);try{const e=await I(r);p(e.items),g(e.total)}catch{o.error("获取用户列表失败")}finally{i(!1)}},x=e=>{n({...r,page:1,keyword:e})},y=e=>{n({...r,page:1,is_member:e})},f=e=>{n({...r,page:e.current||1,page_size:e.pageSize||10})},v=async(e,a)=>{try{await C(e,a?1:0),o.success("状态更新成功"),l()}catch{o.error("状态更新失败")}},j=[{title:"用户",key:"user",render:(e,a)=>t.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[t.jsx(_,{src:a.avatar??void 0,name:a.nickname??void 0,type:"user",size:40,style:{marginRight:12}}),t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:500},children:a.nickname||"未设置昵称"}),t.jsx("div",{style:{color:"var(--color-text-secondary)",fontSize:12},children:a.phone||"未绑定手机"})]})]})},{title:"会员状态",dataIndex:"is_member",key:"is_member",render:e=>t.jsx(R,{color:e?"gold":"default",children:e?"VIP会员":"普通用户"})},{title:"健康豆",dataIndex:"health_beans",key:"health_beans",render:e=>e||0},{title:"优惠券",dataIndex:"coupons",key:"coupons",render:e=>e||0},{title:"状态",dataIndex:"status",key:"status",render:(e,a)=>t.jsx(M,{checked:e===1,onChange:c=>v(a.id,c),checkedChildren:"启用",unCheckedChildren:"禁用"})},{title:"注册时间",dataIndex:"created_at",key:"created_at",render:e=>B(e).format("YYYY-MM-DD HH:mm")},{title:"操作",key:"action",width:100,render:(e,a)=>t.jsx(w,{type:"link",size:"small",icon:t.jsx(z,{}),onClick:()=>d(`/user/detail/${a.id}`),children:"详情"})}];return t.jsxs("div",{className:"fade-in",children:[t.jsx("div",{style:{marginBottom:24,display:"flex",alignItems:"center",justifyContent:"space-between",backgroundImage:"linear-gradient(135deg, rgba(255,255,255,0.85) 0%, rgba(255,255,255,0.7) 100%), url(/images/user-people.png)",backgroundSize:"cover, cover",backgroundPosition:"center, center",borderRadius:"var(--radius-lg)",padding:"24px 32px"},children:t.jsxs("div",{children:[t.jsx("h1",{style:{fontSize:"var(--font-size-2xl)",fontWeight:600,color:"var(--color-text-primary)",marginBottom:4},children:"用户管理"}),t.jsx("p",{style:{color:"var(--color-text-secondary)"},children:"管理平台用户信息"})]})}),t.jsxs("div",{style:{marginBottom:16,display:"flex",alignItems:"center",gap:16},children:[t.jsx(k.Search,{placeholder:"搜索用户昵称/手机号",allowClear:!0,onSearch:x,style:{width:300},prefix:t.jsx(b,{style:{color:"var(--color-text-tertiary)"}})}),t.jsx(T,{placeholder:"会员状态",allowClear:!0,style:{width:120},onChange:y,options:[{value:!0,label:"VIP会员"},{value:!1,label:"普通用户"}]})]}),t.jsx(E,{columns:j,dataSource:m,rowKey:"id",loading:h,locale:{emptyText:t.jsx(D,{description:"暂无用户数据",imageSize:120})},pagination:{current:r.page,pageSize:r.page_size,total:u,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条`},onChange:f})]})}export{V as default};
