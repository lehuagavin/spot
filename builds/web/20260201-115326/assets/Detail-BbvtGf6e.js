import{u as L,aL as O,r as s,z as T,t as e,S as U,D as f,a6 as y,v as j}from"./index-vJliTLcA.js";import{a as B,b as H,c as w}from"./users-goSly9qg.js";import{g as p}from"./upload-BK1CmKxZ.js";import{O as $,a as A}from"./index-CVB0USnY.js";import{d as n}from"./Pagination-BDGMd9qO.js";import{L as c,D as a}from"./index-Ccf35oLF.js";import{T as o}from"./index-Bt7cSXZv.js";import{F as E}from"./Table-CXsedqLq.js";import{R as F}from"./ArrowLeftOutlined-B9YucnSr.js";import{C as v,T as N}from"./index-Jv-BLjlb.js";import"./Skeleton-6-sq-quy.js";import"./PlusOutlined-CYRhG2uJ.js";function re(){const l=L(),{id:i}=O(),[b,m]=s.useState(!0),[r,I]=s.useState(null),[x,S]=s.useState([]),[h,_]=s.useState([]),[k,u]=s.useState(!1),[D,g]=s.useState(!1);s.useEffect(()=>{i&&Y()},[i]);const Y=async()=>{m(!0);try{const t=await B(i);I(t),M(),R()}catch{T.error("获取用户详情失败")}finally{m(!1)}},M=async()=>{u(!0);try{const t=await H(i);S(t)}catch(t){console.error("获取学员列表失败:",t)}finally{u(!1)}},R=async()=>{g(!0);try{const t=await w(i);_(t.items)}catch(t){console.error("获取订单列表失败:",t)}finally{g(!1)}},z=[{title:"订单号",dataIndex:"order_no",key:"order_no",render:(t,d)=>e.jsx("a",{onClick:()=>l(`/order/detail/${d.id}`),children:t})},{title:"课程",key:"course",render:(t,d)=>d.course?.name||"-"},{title:"金额",dataIndex:"pay_amount",key:"pay_amount",render:t=>`¥${Number(t).toFixed(2)}`},{title:"状态",dataIndex:"status",key:"status",render:t=>e.jsx(o,{color:A[t],children:$[t]})},{title:"创建时间",dataIndex:"created_at",key:"created_at",render:t=>n(t).format("MM-DD HH:mm")}];if(b)return e.jsx("div",{style:{textAlign:"center",padding:100},children:e.jsx(U,{size:"large"})});if(!r)return e.jsxs("div",{style:{textAlign:"center",padding:100},children:[e.jsx("p",{children:"用户不存在"}),e.jsx(f,{onClick:()=>l("/user/list"),children:"返回列表"})]});const C=[{key:"students",label:`学员 (${x.length})`,children:e.jsx(c,{loading:k,dataSource:x,locale:{emptyText:"暂无学员"},renderItem:t=>e.jsx(c.Item,{children:e.jsx(c.Item.Meta,{avatar:e.jsx(y,{src:p(t.photo),icon:e.jsx(j,{}),size:48,style:{backgroundColor:"var(--color-primary)"}}),title:t.id_name,description:e.jsxs("div",{children:[e.jsx("span",{style:{marginRight:16},children:t.gender==="male"?"男":"女"}),e.jsx("span",{style:{marginRight:16},children:n(t.birthday).format("YYYY-MM-DD")}),e.jsx(o,{color:t.member_type==="vip"?"gold":"default",children:t.member_type==="vip"?"VIP会员":"普通会员"})]})})})})},{key:"orders",label:`订单 (${h.length})`,children:e.jsx(E,{columns:z,dataSource:h,rowKey:"id",loading:D,pagination:!1,size:"small"})}];return e.jsxs("div",{className:"fade-in",children:[e.jsxs("div",{style:{marginBottom:24,display:"flex",alignItems:"center"},children:[e.jsx(f,{icon:e.jsx(F,{}),onClick:()=>l("/user/list"),style:{marginRight:16},children:"返回"}),e.jsx("div",{children:e.jsx("h1",{style:{fontSize:"var(--font-size-2xl)",fontWeight:600,marginBottom:4},children:"用户详情"})})]}),e.jsxs(v,{style:{marginBottom:24,borderRadius:"var(--radius-lg)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:24},children:[e.jsx(y,{src:p(r.avatar),icon:e.jsx(j,{}),size:80,style:{backgroundColor:"var(--color-primary)",marginRight:24}}),e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"var(--font-size-xl)",fontWeight:600,marginBottom:8},children:r.nickname||"未设置昵称"}),e.jsxs("div",{style:{display:"flex",gap:12},children:[e.jsx(o,{color:r.is_member?"gold":"default",children:r.is_member?"VIP会员":"普通用户"}),e.jsx(o,{color:r.status===1?"success":"error",children:r.status===1?"正常":"已禁用"})]})]})]}),e.jsxs(a,{column:3,children:[e.jsx(a.Item,{label:"手机号",children:r.phone||"-"}),e.jsx(a.Item,{label:"健康豆",children:r.health_beans||0}),e.jsx(a.Item,{label:"优惠券",children:r.coupons||0}),e.jsx(a.Item,{label:"注册时间",children:n(r.created_at).format("YYYY-MM-DD HH:mm:ss")}),e.jsx(a.Item,{label:"最后更新",children:n(r.updated_at).format("YYYY-MM-DD HH:mm:ss")})]})]}),e.jsx(v,{style:{borderRadius:"var(--radius-lg)"},children:e.jsx(N,{items:C})})]})}export{re as default};
