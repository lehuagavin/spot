import{r as a,F as s,z as o,t,A as c,B as D,D as p,E as F}from"./index-vJliTLcA.js";import{g as M,u as _,c as B,d as L}from"./teachers-DYIQ3x04.js";import{I as $,R as A}from"./ImageUpload-BD2lY4S1.js";import{D as P}from"./DefaultAvatar-BHbKO5BL.js";import{E as Y}from"./EmptyState-BSaaD0E3.js";import{d as V}from"./Pagination-BDGMd9qO.js";import{R as q}from"./PlusOutlined-CYRhG2uJ.js";import{F as H}from"./Table-CXsedqLq.js";import{M as O}from"./index-CuHp8ad1.js";import{T as W}from"./index-Bt7cSXZv.js";import{R as J}from"./EditOutlined-CyLgl2ms.js";import{P as K}from"./index-BeHdL7jP.js";import"./upload-BK1CmKxZ.js";import"./progress-CwHhQgc-.js";import"./Skeleton-6-sq-quy.js";function ce(){const[g,u]=a.useState(!1),[y,j]=a.useState([]),[S,I]=a.useState(0),[r,h]=a.useState({page:1,page_size:10}),[b,i]=a.useState(!1),[d,x]=a.useState(null),[l]=s.useForm(),[v,f]=a.useState(!1);a.useEffect(()=>{m()},[r]);const m=async()=>{u(!0);try{const e=await M(r);j(e.items),I(e.total)}catch{o.error("获取教练列表失败")}finally{u(!1)}},w=e=>{h({...r,page:1,keyword:e})},k=e=>{h({...r,page:e.current||1,page_size:e.pageSize||10})},T=()=>{x(null),l.resetFields(),i(!0)},z=e=>{x(e),l.setFieldsValue(e),i(!0)},C=async e=>{try{await L(e),o.success("删除成功"),m()}catch{o.error("删除失败")}},R=async()=>{try{const e=await l.validateFields();f(!0),d?(await _(d.id,e),o.success("更新成功")):(await B(e),o.success("创建成功")),i(!1),m()}catch(e){e instanceof Error&&o.error(e.message)}finally{f(!1)}},E=[{title:"头像",dataIndex:"avatar",key:"avatar",width:80,render:(e,n)=>t.jsx(P,{src:e??void 0,name:n.name,type:"teacher",size:48})},{title:"姓名",dataIndex:"name",key:"name",render:e=>t.jsx("span",{style:{fontWeight:500},children:e})},{title:"手机号",dataIndex:"phone",key:"phone"},{title:"简介",dataIndex:"introduction",key:"introduction",ellipsis:!0,render:e=>e||"-"},{title:"状态",dataIndex:"status",key:"status",render:e=>t.jsx(W,{color:e===1?"success":"default",children:e===1?"在职":"离职"})},{title:"创建时间",dataIndex:"created_at",key:"created_at",render:e=>V(e).format("YYYY-MM-DD HH:mm")},{title:"操作",key:"action",width:150,render:(e,n)=>t.jsxs(F,{children:[t.jsx(p,{type:"link",size:"small",icon:t.jsx(J,{}),onClick:()=>z(n),children:"编辑"}),t.jsx(K,{title:"确定要删除这个教练吗？",onConfirm:()=>C(n.id),okText:"确定",cancelText:"取消",children:t.jsx(p,{type:"link",size:"small",danger:!0,icon:t.jsx(A,{}),children:"删除"})})]})}];return t.jsxs("div",{className:"fade-in",children:[t.jsx("div",{style:{marginBottom:24,display:"flex",alignItems:"center",justifyContent:"space-between",backgroundImage:"linear-gradient(135deg, rgba(255,255,255,0.85) 0%, rgba(255,255,255,0.7) 100%), url(/images/teacher-coach.png)",backgroundSize:"cover, cover",backgroundPosition:"center, center",borderRadius:"var(--radius-lg)",padding:"24px 32px"},children:t.jsxs("div",{children:[t.jsx("h1",{style:{fontSize:"var(--font-size-2xl)",fontWeight:600,color:"var(--color-text-primary)",marginBottom:4},children:"教练管理"}),t.jsx("p",{style:{color:"var(--color-text-secondary)"},children:"管理平台教练信息"})]})}),t.jsxs("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(c.Search,{placeholder:"搜索教练姓名或手机号",allowClear:!0,onSearch:w,style:{width:300},prefix:t.jsx(D,{style:{color:"var(--color-text-tertiary)"}})}),t.jsx(p,{type:"primary",icon:t.jsx(q,{}),onClick:T,children:"新增教练"})]}),t.jsx(H,{columns:E,dataSource:y,rowKey:"id",loading:g,locale:{emptyText:t.jsx(Y,{description:"暂无教练数据",imageSize:120})},pagination:{current:r.page,pageSize:r.page_size,total:S,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条`},onChange:k}),t.jsx(O,{title:d?"编辑教练":"新增教练",open:b,onCancel:()=>i(!1),onOk:R,confirmLoading:v,width:600,destroyOnClose:!0,children:t.jsxs(s,{form:l,layout:"vertical",style:{marginTop:24},children:[t.jsx(s.Item,{name:"avatar",label:"头像",children:t.jsx($,{})}),t.jsx(s.Item,{name:"name",label:"姓名",rules:[{required:!0,message:"请输入教练姓名"}],children:t.jsx(c,{placeholder:"请输入教练姓名"})}),t.jsx(s.Item,{name:"phone",label:"手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号"}],children:t.jsx(c,{placeholder:"请输入手机号"})}),t.jsx(s.Item,{name:"introduction",label:"简介",children:t.jsx(c.TextArea,{placeholder:"请输入教练简介",rows:3})})]})})]})}export{ce as default};
