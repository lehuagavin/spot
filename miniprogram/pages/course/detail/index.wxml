<!-- è¯¾ç¨‹è¯¦æƒ…é¡µé¢ -->
<view class="page-container">
  <!-- åŠ è½½ä¸­ -->
  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
  
  <block wx:elif="{{course}}">
    <!-- å¤´éƒ¨å“ç‰ŒåŒº -->
    <view class="brand-section">
      <view class="brand-logo">
        <text class="logo-text">ä¹‰åŸä¸Šé—¨æ•™è‚²</text>
        <text class="logo-sub">YICHENG HOME EDUCATION</text>
      </view>
      <view class="brand-tags">
        <view class="brand-tag">çº¿ä¸Šé¢„çº¦</view>
        <view class="brand-tag">é¦–æ¬¡ä»˜è´¹</view>
        <view class="brand-tag">æ•™ç»ƒä¸Šé—¨</view>
        <view class="brand-tag">æˆ·å¤–æ•™å­¦</view>
        <view class="brand-tag">å¿«ä¹è¿åŠ¨</view>
      </view>
    </view>
    
    <!-- è¯¾ç¨‹ä¿¡æ¯ -->
    <view class="course-section">
      <view class="course-header">
        <view class="course-title">
          <text class="age-tag">({{course.age_range || '7-12å²'}})</text>
          <text class="course-name">{{course.name}}</text>
        </view>
        <view class="status-tag {{course.status === 'enrolling' ? 'enrolling' : ''}}">
          {{course.status === 'enrolling' ? 'æŠ¥åä¸­' : course.status === 'ongoing' ? 'è¿›è¡Œä¸­' : 'å·²ç»“æŸ'}}
        </view>
      </view>
      
      <!-- æ•™ç»ƒä¿¡æ¯ -->
      <view class="info-row" wx:if="{{course.teacher}}">
        <view class="info-label">ä¸Šè¯¾è€å¸ˆ</view>
        <view class="info-value">
          <view class="teacher-avatar">
            <image wx:if="{{course.teacher.avatar}}" src="{{course.teacher.avatar}}" mode="aspectFill"/>
            <text wx:else>ğŸ‘¨â€ğŸ«</text>
          </view>
          <text class="teacher-name">{{course.teacher.name}}</text>
        </view>
      </view>
      
      <!-- è¯¾ç¨‹å‘¨æœŸ -->
      <view class="info-row">
        <view class="info-label">è¯¾ç¨‹å‘¨æœŸ</view>
        <view class="info-value">ç¬¬{{course.current_week || 1}}å‘¨ - ç¬¬{{course.total_weeks || 10}}å‘¨</view>
      </view>
      
      <view class="info-row">
        <view class="info-label">ä¸Šè¯¾å‘¨æœŸ</view>
        <view class="info-value">å…±{{course.total_weeks || 10}}å‘¨ï¼Œ{{course.total_lessons || 10}}èŠ‚è¯¾</view>
      </view>
      
      <!-- æ—¶é—´åœ°ç‚¹ -->
      <view class="info-row">
        <view class="info-label">ä¸Šè¯¾æ—¶é—´</view>
        <view class="info-value">{{course.schedule || 'å¾…å®š'}}</view>
      </view>
      
      <view class="info-row">
        <view class="info-label">ä¸Šè¯¾åœ°ç‚¹</view>
        <view class="info-value address">
          <text>{{course.community_name}}</text>
          <text class="address-detail">{{course.address}}</text>
        </view>
      </view>
      
      <!-- æˆªæ­¢æ—¶é—´ -->
      <view class="info-row">
        <view class="info-label">æˆç­æˆªæ­¢</view>
        <view class="info-value deadline">{{course.deadline}}</view>
      </view>
    </view>
    
    <!-- ä»·æ ¼ä¿¡æ¯ -->
    <view class="price-section">
      <view class="price-row">
        <view class="price-label">è¯¾ç¨‹å•ä»·</view>
        <view class="price-value">
          <text class="price-symbol">Â¥</text>
          <text class="price-amount">{{course.price || 80}}</text>
          <text class="price-unit">/èŠ‚</text>
        </view>
      </view>
      
      <view class="price-row member">
        <view class="price-label">
          <view class="member-badge">ä¼šå‘˜</view>
          <text>æƒç›Šå¡ä»·æ ¼</text>
        </view>
        <view class="price-value member-price">
          <text class="price-symbol">Â¥</text>
          <text class="price-amount">{{course.member_price || 39.8}}</text>
          <text class="price-unit">/èŠ‚</text>
        </view>
      </view>
      
      <view class="saving-tip">
        <text class="tip-icon">ğŸ’¡</text>
        <text>ä¼šå‘˜æƒç›Šå¡æ¯èŠ‚è¯¾ä¸ºæ‚¨èŠ‚çœ Â¥{{savingAmount}}</text>
      </view>
    </view>
    
    <!-- æŠ¥åä¿¡æ¯ -->
    <view class="enroll-section">
      <view class="enroll-header">
        <view class="enroll-title">æŠ¥åä¿¡æ¯</view>
        <view class="enroll-stats">
          <text class="stats-item">{{course.max_students || 10}}äººç­</text>
          <text class="stats-divider">|</text>
          <text class="stats-item">æ»¡{{course.min_students || 4}}äººæˆç­</text>
          <text class="stats-divider">|</text>
          <text class="stats-item highlight">å‰©ä½™{{remainingSlots}}ä¸ªåé¢</text>
        </view>
      </view>
      
      <!-- å·²æŠ¥åå­¦å‘˜ -->
      <view class="enrolled-list" wx:if="{{enrolledStudents.length > 0}}">
        <text class="enrolled-label">å·²æŠ¥åå­¦å‘˜</text>
        <view class="enrolled-avatars">
          <view 
            class="enrolled-avatar"
            wx:for="{{enrolledStudents}}"
            wx:key="index"
            wx:if="{{index < 8}}"
          >
            <image wx:if="{{item.avatar}}" src="{{item.avatar}}" mode="aspectFill"/>
            <text wx:else>ğŸ‘¤</text>
          </view>
          <view class="enrolled-more" wx:if="{{enrolledStudents.length > 8}}">
            +{{enrolledStudents.length - 8}}
          </view>
        </view>
      </view>
    </view>
    
    <!-- æ‹¼ç­è¯´æ˜ -->
    <view class="notice-section">
      <view class="notice-title">æ‹¼ç­è¯´æ˜</view>
      <view class="notice-list">
        <view class="notice-item">
          <text class="notice-num">1</text>
          <text class="notice-text">æ”¯ä»˜æˆåŠŸå³è§†ä¸ºæ‹¼ç­æˆåŠŸ</text>
        </view>
        <view class="notice-item">
          <text class="notice-num">2</text>
          <text class="notice-text">æ‰€æ”¯ä»˜çš„è´¹ç”¨ä¸ºè¯¥äº§å“çš„å®é™…ä»·æ ¼</text>
        </view>
        <view class="notice-item">
          <text class="notice-num">3</text>
          <text class="notice-text">æŠ¥åæ—¶é—´æˆªæ­¢å‰éšæ—¶å¯ç”³è¯·é€€æ¬¾ï¼ŒæŠ¥åæ—¶é—´æˆªæ­¢åè´¹ç”¨ä¸é€€</text>
        </view>
        <view class="notice-item">
          <text class="notice-num">4</text>
          <text class="notice-text">è‹¥é‡åˆ°ä¸å¯æŠ—æ‹’å› ç´ ï¼ˆå¤©æ°”ã€åœºåœ°ä¸æ»¡è¶³å¼€ç­äººæ•°ç­‰ï¼‰è¯¥ç­å°†è§£æ•£ï¼Œè´¹ç”¨å°†åœ¨10åˆ†é’Ÿå†…è‡ªåŠ¨åŸè·¯è¿”è¿˜</text>
        </view>
      </view>
    </view>
    
    <!-- åº•éƒ¨å ä½ -->
    <view class="bottom-placeholder"></view>
  </block>
</view>

<!-- åº•éƒ¨æ“ä½œæ  -->
<view class="bottom-bar" wx:if="{{course}}">
  <view class="bar-actions">
    <button class="action-btn" open-type="share">
      <text class="action-icon">ğŸ“¤</text>
      <text class="action-text">åˆ†äº«</text>
    </button>
    <button class="action-btn" open-type="contact">
      <text class="action-icon">ğŸ’¬</text>
      <text class="action-text">å®¢æœ</text>
    </button>
  </view>
  
  <button 
    class="join-btn {{remainingSlots <= 0 || course.status !== 'enrolling' ? 'disabled' : ''}}"
    bindtap="onJoinClass"
  >
    {{remainingSlots <= 0 ? 'åé¢å·²æ»¡' : course.status !== 'enrolling' ? 'æš‚ä¸å¯æŠ¥å' : 'åŠ å…¥æ‹¼ç­'}}
  </button>
</view>
