<!-- å°åŒºåˆ—è¡¨é¡µé¢ -->
<view class="page-container">
  <!-- æœç´¢æ  -->
  <view class="search-section">
    <view class="search-bar">
      <view class="search-icon">ğŸ”</view>
      <input 
        class="search-input"
        type="text"
        placeholder="æœç´¢å°åŒºåç§°"
        placeholder-class="search-placeholder"
        value="{{keyword}}"
        bindinput="onSearchInput"
        bindconfirm="onSearchConfirm"
        confirm-type="search"
      />
      <view 
        class="search-clear" 
        wx:if="{{keyword}}"
        bindtap="onSearchClear"
      >âœ•</view>
    </view>
    
    <!-- åœ°å›¾å…¥å£ -->
    <view class="map-btn" bindtap="onOpenMap">
      <text class="map-icon">ğŸ—ºï¸</text>
      <text class="map-text">åœ°å›¾</text>
    </view>
  </view>
  
  <!-- æœç´¢å†å² -->
  <view class="history-section" wx:if="{{showHistory && searchHistory.length > 0}}">
    <view class="section-header">
      <text class="section-title">æœç´¢å†å²</text>
      <text class="section-action" bindtap="onClearHistory">æ¸…ç©º</text>
    </view>
    <view class="history-tags">
      <view 
        class="history-tag"
        wx:for="{{searchHistory}}"
        wx:key="*this"
        bindtap="onHistoryTap"
        data-keyword="{{item}}"
      >{{item}}</view>
    </view>
  </view>
  
  <!-- å°åŒºåˆ—è¡¨ -->
  <view class="community-section">
    <!-- åŠ è½½ä¸­ -->
    <view class="loading-state" wx:if="{{loading && communities.length === 0}}">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
    
    <!-- åˆ—è¡¨ -->
    <view class="community-list" wx:elif="{{communities.length > 0}}">
      <!-- å…¨éƒ¨å°åŒºé€‰é¡¹ï¼ˆå–æ¶ˆå®šä½ï¼‰ -->
      <view 
        class="community-item all-item {{!selectedId ? 'selected' : ''}}"
        bindtap="onSelectAll"
      >
        <view class="item-icon-wrap">
          <text class="all-icon">ğŸŒ</text>
        </view>
        <view class="item-content">
          <view class="item-name">å…¨éƒ¨å°åŒº</view>
          <view class="item-address">æ˜¾ç¤ºæ‰€æœ‰å°åŒºçš„è¯¾ç¨‹</view>
        </view>
        <view class="item-check" wx:if="{{!selectedId}}">
          <text class="check-icon">âœ“</text>
        </view>
      </view>
      
      <!-- å°åŒºåˆ—è¡¨ -->
      <view 
        class="community-item {{item.id === selectedId ? 'selected' : ''}}"
        wx:for="{{communities}}"
        wx:key="id"
        bindtap="onSelectCommunity"
        data-item="{{item}}"
      >
        <!-- å›¾ç‰‡ -->
        <view class="item-image">
          <image 
            wx:if="{{item.image}}"
            src="{{item.image}}" 
            mode="aspectFill"
          />
          <view class="image-placeholder" wx:else>ğŸ˜ï¸</view>
        </view>
        
        <!-- ä¿¡æ¯ -->
        <view class="item-content">
          <view class="item-name">{{item.name}}</view>
          <view class="item-address truncate">{{item.address}}</view>
        </view>
        
        <!-- è·ç¦» -->
        <view class="item-distance" wx:if="{{item.distanceValue}}">
          <text class="distance-value">{{item.distanceValue}}</text>
          <text class="distance-unit">{{item.distanceUnit}}</text>
        </view>
        
        <!-- é€‰ä¸­æ ‡è®° -->
        <view class="item-check" wx:if="{{item.id === selectedId}}">
          <text class="check-icon">âœ“</text>
        </view>
      </view>
    </view>
    
    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:else>
      <view class="empty-icon">ğŸ˜ï¸</view>
      <text class="empty-text">æœªæ‰¾åˆ°å°åŒº</text>
      <text class="empty-hint">æ¢ä¸ªå…³é”®è¯è¯•è¯•</text>
    </view>
  </view>
</view>
