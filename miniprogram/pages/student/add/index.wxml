<!-- 新增/编辑学员页面 -->
<view class="page-container">
  <!-- 表单卡片 -->
  <view class="form-card">
    <!-- 证件类型 -->
    <picker 
      class="form-row"
      mode="selector"
      range="{{idTypes}}"
      range-key="label"
      value="{{idTypeIndex}}"
      bindchange="onIdTypeChange"
    >
      <view class="form-row-inner">
        <view class="form-label">
          <text class="required">*</text>
          <text>证件类型</text>
        </view>
        <view class="form-value-wrapper">
          <text class="form-value">{{idTypes[idTypeIndex].label}}</text>
          <text class="form-arrow">></text>
        </view>
      </view>
    </picker>
    
    <!-- 证件姓名 -->
    <view class="form-row">
      <view class="form-row-inner">
        <view class="form-label">
          <text class="required">*</text>
          <text>证件姓名</text>
        </view>
        <view class="form-value-wrapper">
          <input 
            class="form-input {{form.name ? '' : 'placeholder'}}"
            placeholder="证件姓名"
            placeholder-class="input-placeholder"
            value="{{form.name}}"
            bindinput="onNameInput"
          />
          <text class="form-arrow">></text>
        </view>
      </view>
    </view>
    
    <!-- 证件号码 -->
    <view class="form-row">
      <view class="form-row-inner">
        <view class="form-label">
          <text class="required">*</text>
          <text>证件号码</text>
        </view>
        <view class="form-value-wrapper">
          <input 
            class="form-input {{form.id_number ? '' : 'placeholder'}}"
            placeholder="证件号码"
            placeholder-class="input-placeholder"
            value="{{form.id_number}}"
            bindinput="onIdNumberInput"
          />
          <text class="form-arrow">></text>
        </view>
      </view>
    </view>
    
    <!-- 提示文字 -->
    <view class="notice-text">
      提示：个人信息仅用于购买保险使用，请填写真实身份信息，信息有误将影响保险生效，由此产生的损失自负全责
    </view>
    
    <!-- 照片 -->
    <view class="form-row photo-row">
      <view class="form-row-inner">
        <view class="form-label">
          <text>照片</text>
        </view>
        <view class="form-value-wrapper">
          <view class="photo-circle" wx:if="{{form.photo}}" bindtap="onPreviewPhoto">
            <image src="{{form.photo}}" mode="aspectFill" class="photo-img" binderror="onPhotoError"/>
            <view class="photo-delete" catchtap="onDeletePhoto">×</view>
          </view>
          <view class="photo-circle photo-empty" wx:else bindtap="onChoosePhoto">
            <text class="photo-placeholder"></text>
          </view>
          <text class="form-arrow">></text>
        </view>
      </view>
    </view>
    
    <!-- 出生日期 -->
    <picker 
      class="form-row"
      mode="date"
      start="{{startDate}}"
      end="{{endDate}}"
      value="{{form.birthday}}"
      bindchange="onBirthdayChange"
    >
      <view class="form-row-inner">
        <view class="form-label">
          <text class="required">*</text>
          <text>出生日期</text>
        </view>
        <view class="form-value-wrapper">
          <text class="form-value {{form.birthday ? '' : 'placeholder'}}">{{form.birthday || '出生日期'}}</text>
          <text class="form-arrow">></text>
        </view>
      </view>
    </picker>
    
    <!-- 性别 -->
    <picker 
      class="form-row no-border"
      mode="selector"
      range="{{genders}}"
      range-key="label"
      value="{{genderIndex}}"
      bindchange="onGenderChange"
    >
      <view class="form-row-inner">
        <view class="form-label">
          <text class="required">*</text>
          <text>性别</text>
        </view>
        <view class="form-value-wrapper">
          <text class="form-value {{genderIndex >= 0 ? '' : 'placeholder'}}">{{genders[genderIndex].label || '选择性别'}}</text>
          <text class="form-arrow">></text>
        </view>
      </view>
    </picker>
  </view>
  
  <!-- 底部占位 -->
  <view class="bottom-placeholder"></view>
</view>

<!-- 底部按钮 -->
<view class="bottom-bar">
  <button 
    class="submit-btn {{submitting ? 'loading' : ''}}"
    bindtap="onSubmit"
    disabled="{{submitting}}"
  >
    {{submitting ? '提交中...' : '提 交'}}
  </button>
</view>

<!-- 选择微信头像弹窗 -->
<view class="avatar-modal" wx:if="{{showAvatarModal && !choosingAvatar}}" catchtap="onCloseAvatarModal">
  <view class="avatar-modal-content" catchtap="stopPropagation">
    <view class="avatar-modal-title">选择微信头像</view>
    <view class="avatar-modal-desc">点击下方按钮选择您的微信头像</view>
    <button 
      class="avatar-modal-btn"
      open-type="chooseAvatar"
      bindchooseavatar="onChooseWechatAvatar"
      disabled="{{choosingAvatar}}"
    >
      选择微信头像
    </button>
    <view class="avatar-modal-cancel" bindtap="onCloseAvatarModal">取消</view>
  </view>
</view>
