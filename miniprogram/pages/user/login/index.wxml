<!-- 登录页面 -->
<view class="page-container">
  <!-- 返回按钮 -->
  <view class="back-btn" bindtap="onBack">
    <text class="back-icon">‹</text>
  </view>
  
  <!-- Logo 区域 -->
  <view class="logo-section">
    <view class="logo-circle">
      <text class="logo-emoji">🏃</text>
    </view>
    <view class="brand-name">义城上门教育</view>
    <view class="brand-sub">YICHENG HOME EDUCATION</view>
  </view>
  
  <!-- 步骤一：微信登录 -->
  <block wx:if="{{step === 'login'}}">
    <!-- 授权说明 -->
    <view class="auth-section">
      <view class="auth-title">申请使用以下信息</view>
      <view class="auth-item">
        <text class="auth-icon">👤</text>
        <text class="auth-text">获取您的微信账号信息</text>
      </view>
    </view>
    
    <!-- 操作按钮 -->
    <view class="action-section">
      <button 
        class="login-btn {{loading ? 'loading' : ''}}"
        bindtap="onWechatLogin"
        disabled="{{loading}}"
      >
        <view class="btn-content">
          <text class="btn-icon" wx:if="{{!loading}}">💬</text>
          <view class="loading-spinner" wx:else></view>
          <text class="btn-text">{{loading ? '登录中...' : '微信快捷登录'}}</text>
        </view>
      </button>
      
      <button class="back-home-btn" bindtap="onBack">
        返回首页
      </button>
    </view>
  </block>

  <!-- 步骤二：完善个人信息（头像+手机号） -->
  <block wx:if="{{step === 'bindPhone'}}">
    <view class="profile-section">
      <view class="profile-title">完善个人信息</view>
      <view class="profile-desc">设置头像和绑定手机号，享受更好的服务体验</view>
      
      <!-- 头像选择 -->
      <view class="avatar-picker">
        <button class="avatar-btn" open-type="chooseAvatar" bindchooseavatar="onChooseAvatar">
          <view class="avatar-circle">
            <image wx:if="{{tempAvatarUrl}}" src="{{tempAvatarUrl}}" mode="aspectFill"/>
            <text wx:else class="avatar-placeholder">👤</text>
          </view>
          <view class="avatar-edit">
            <text class="edit-icon">📷</text>
            <text class="edit-text">{{tempAvatarUrl ? '更换头像' : '选择微信头像'}}</text>
          </view>
        </button>
      </view>
    </view>
    
    <view class="action-section">
      <button 
        class="phone-btn {{phoneLoading ? 'loading' : ''}}"
        open-type="getPhoneNumber"
        bindgetphonenumber="onGetPhoneNumber"
        disabled="{{phoneLoading}}"
      >
        <view class="btn-content">
          <view class="loading-spinner" wx:if="{{phoneLoading}}"></view>
          <text class="btn-text" wx:else>一键绑定微信手机号</text>
        </view>
      </button>
      
      <button class="skip-btn" bindtap="onSkipBind">
        暂不设置，先看看
      </button>
    </view>
  </block>
  
  <!-- 协议 -->
  <view class="agreement-section">
    <view class="agreement-row">
      <text class="agreement-text">登录即表示同意</text>
      <text class="agreement-link" bindtap="onShowUserAgreement">《用户协议》</text>
      <text class="agreement-text">和</text>
      <text class="agreement-link" bindtap="onShowPrivacyPolicy">《隐私政策》</text>
    </view>
  </view>
</view>
